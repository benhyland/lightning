<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">

		<title>Better than mocking - not mocking</title>

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/moon.css">
		<link rel="stylesheet" href="css/sunburst.css">
	</head>

	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h2>Mocks and how to avoid them</h2>
				</section>
				<section>
					<h2>Why are we here?</h2>
					<p>
						<ul>
							<li>mocking is usually awful, let's understand why</li>
							<li>there are often better alternatives, so let's learn about them</li>
							<li>mocking is helpful sometimes, let's mention some times</li>
						</ul>
					</p>
				</section>
				<section>
					<h2>Mocking is awful</h2>
					<p>code example of horrible mock</p>
				</section>
				<section>
					<h2>Mock tests are not good value</h2>
					<p>Cost to write is low, but cost of maintenance tends to be high- mocks are brittle</p>
					<p>Bugs found and protection against regression is low</p>
					<p>Mock tests tend to test wiring or coupling rather than something more useful</p>
					<p>- Wiring bugs are generally caught by integration or acceptance tests</p>
					<p>- Coupling is an implementation detail that should not be observable</p>
				</section>
				<section>
					<h2>Mocking at its worst</h2>
					<p>Everybody agrees that nested mocks, or numerous mocks per test are bad.</p>
					<p>Both imply poor encapsulation in the application code.</p>
				</section>
				<section>
					<h2>How to not mock</h2>
					<p>Let's talk about some alternatives</p>
				</section>
				<section>
					<h2>Test real input and output</h2>
					<p>code example of testing data rather than mocks</p>
					<p>A common justification for mocks here is that it can be hard to write appropriate data builders.</p>
					<p>However, a small time investment here is worth a great deal longer term, and will probably help in application code and domain modellling too.</p>
				</section>
				<section>
					<h2>Functional decomposition</h2>
					<p>code example of extracting effect as a value</p>
					<p>code example of undoing tell don't ask</p>
					<p>Notice that ctor injection is lifted up the class dependency tree.</p>
				</section>
				<section>
					<h2>Test at an appropriate level</h2>
					<p>A Unit doesn't mean a class.</p>
					<p>If several classes are tightly coupled, it's OK to unit test them together.</p>
					<p>Otherwise, organise their interactions so as to minimise 'glue' code.</p>
					<p>Unit test them separately.</p>
					<p>Test the glue at integration or acceptance level.</p>
					<p>Much better return on investment in the longer term.</p>
				</section>
				<section>
					<h2>When to mock</h2>
					<p>If you have an interaction that you can't factor out yet</p>
					<p>code example of 2-dimension-configurable data transformer?</p>
				</section>
				<section>
					<h2>When to mock</h2>
					<p>If you have an interaction which is genuinely an effect, from the pov of your component (not just your unit)</p>
					<p>code example of effect</p>
				</section>
			</div>
		</div>
        
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,
				
				width: 1152,

				theme: 'moon',
				transition: 'none',

				dependencies: [
					{ src: 'plugin/highlight/highlight.pack.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]

			});

		</script>

	</body>
</html>
